<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Candis Wu, Jade Michael O’Brien, Joseph Zaki, Daniel Ariel Ledvin">
<meta name="dcterms.date" content="2024-10-30">

<title>Biomarkers of ASD</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="report_files/libs/clipboard/clipboard.min.js"></script>
<script src="report_files/libs/quarto-html/quarto.js"></script>
<script src="report_files/libs/quarto-html/popper.min.js"></script>
<script src="report_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="report_files/libs/quarto-html/anchor.min.js"></script>
<link href="report_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="report_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="report_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="report_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="report_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="report_files/libs/quarto-diagram/mermaid.min.js"></script>
<script src="report_files/libs/quarto-diagram/mermaid-init.js"></script>
<link href="report_files/libs/quarto-diagram/mermaid.css" rel="stylesheet">
<script src="report_files/libs/kePrint-0.0.1/kePrint.js"></script>

<link href="report_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">



</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Biomarkers of ASD</h1>
<p class="subtitle lead">Group 8</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Candis Wu, Jade Michael O’Brien, Joseph Zaki, Daniel Ariel Ledvin </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Updated</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 30, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="abstract" class="level2">
<h2 class="anchored" data-anchor-id="abstract">Abstract</h2>
<p>This report explores the identification of biomarkers associated with Autism Spectrum Disorder (ASD) using data from L. Hewitson’s experiment in 2021. Though the original report has since been retracted due to unreliable methodology, this report explores the data and tests alternate methods to those used in the original study. We started with testing why the data was log-transformed, concluding the log-transformation simply made the data more closely resemble a normal distribution, making it easier to work with. We then tested to see if there are any proteins that seem to commonly occur as outliers and if there are any subjects that seem to consistently have outlier protein values. After this analysis, it was apparent that none of the proteins occur disproportionately as outliers, however there were a few patients with over 40 outlier proteins, most of which were in the typically developing (TD) group.</p>
<p>To explore alternative predictive biomarkers, we performed feature selection using a training partition to avoid overfitting and replicated the selection across different methods. Additionally, we experimented with combining sets of top predictive proteins through both a hard intersection and a fuzzy intersection approach, finding that the latter introduced more flexibility while retaining strong classifiers. Performance metrics demonstrated that these panels could contain other potential reliable biomarkers for ASD diagnosis and reinforced the strength of the DERM and IgD proteins as biomarkers.</p>
</section>
<section id="dataset" class="level2">
<h2 class="anchored" data-anchor-id="dataset">Dataset</h2>
<p>Data was collected on 154 male pediatric subjects, 76 of which were diagnosed with autism spectrum disorder (ASD) and the other 78 were determined to be typically developing (TD). Demographic data was collected for all participants, including age, ethnicity, co-morbidities, and psychiatric medications. The mean age of the ASD group was 5.6 years old, and the mean age of subjects from the TD group was 5.7 years old. Additionally, the SOMAScan platform 1.3k was used to measure the levels of 1,317 proteins in each subject. The levels of these proteins were then log10-transformed, standardized, and then outliers were trimmed to values of -3 or 3 depending on their sign.</p>
</section>
<section id="summary-of-published-analysis" class="level2">
<h2 class="anchored" data-anchor-id="summary-of-published-analysis">Summary of published analysis</h2>
<p>In the paper <em>“Blood biomarker discovery for autism spectrum disorder: A proteomic analysis”</em>, Hewitson et al.&nbsp;aim to identify a panel of proteins which can be used as biomarkers for Autism Spectrum Disorder (ASD). The study included 154 male subjects ranging from 18 months of age to 8 years of age. In their paper, Hewitson et al.&nbsp;identified 9 proteins associated with ASD in young boys. After drawing blood from each of the 154 subjects, the SOMAScan platform was used to measure the protein levels of 1,317 proteins in the boys’ serum samples. Before any analysis was performed, the data were normalized by taking a log10 transformation, a z-transformation, and clipping outliers at -3 and 3.</p>
<p>To identify which proteins were strongly associated with ASD, Hewitson et al.&nbsp;used three different methods to determine the significance of each protein, then selected the top 10 most significant proteins from each method.</p>
<ol type="1">
<li>The first method used was a random forest which was used to assign an importance score to each protein. The measure used for this importance score was the Mean Gini Index. The random forest model was trained 1000 times and the proteins’ importance scores were averaged across all 1000 runs. Ultimitely the proteins with the 10 highest scores were selected for this model. The selected proteins were: MAPK14, IgD, DERM, EPHB2, ALCAM, eIF-4H, suPAR, SOST, C6, and Calcineurin.</li>
<li>The second method used was a standard two sample t-test which determines if there is a significant difference in the level of each protein across the TD and ASD groups. The 10 proteins that were found to be most significant were: DERM, suPAR, Calcineurin, MAPK14, EPHB2, RELT, FCN1, IgD, PTN, and C1QR1.</li>
<li>The third method used was a correlation approach, in which the correlation between the levels of each protein and the subjects’ ADOS score (representing severity of ASD) was calculated. The 10 proteins with the highest absolute value of correlation were selected. These proteins were: DERM, RELT, EPHB2, MAPK14, Prolactin Receptor, ROR1, GI24, suPAR, ARSB, and IgD.</li>
</ol>
<p>By combining the results of these three methods, Hewitson et al.&nbsp;identified 18 unqiue proteins to further study. 5 of these proteins were selected by all three of the models (MAPK14, IgD, DERM, EPHB2, suPAR). These 5 proteins were taken to be a “core panel” and each of the remaining 13 proteins was investigated to determine if they added any further predictive power to the logistic regression model.</p>
<p>Finally, 9 proteins were identified to be part of the final biomarker panel. These proteins included the 5 from the core panel (MAPK14, IgD, DERM, EPHB2, suPAR) and four additional proteins which were not identified by all three methods (ROR1, GI24, eIF-4H, ARSB).</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
  A[Gather Data] --&gt; B[Normalize, clip outliers]
  B --&gt; C[Identify 10 proteins - Random Forest]
  B --&gt; D[Identify 10 proteins - t-Test]
  B --&gt; E[Identify 10 proteins - Correlations with ADOS]
  C --&gt; F[Identify core panel - 5 proteins found in all 3 methods]
  D --&gt; F
  E --&gt; F
  C --&gt; G[Individually test remaing proteins]
  D --&gt; G
  E --&gt; G
  F --&gt; Z[Final panel]
  G --&gt; Z
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="findings" class="level2">
<h2 class="anchored" data-anchor-id="findings">Findings</h2>
<section id="impact-of-preprocessing-and-outliers-task-1-2" class="level3">
<h3 class="anchored" data-anchor-id="impact-of-preprocessing-and-outliers-task-1-2">Impact of preprocessing and outliers (Task 1 &amp; 2)</h3>
<section id="log-transform" class="level4">
<h4 class="anchored" data-anchor-id="log-transform">Log-Transform</h4>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="report_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Mean Levels of Selected Proteins</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Protein</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean Level</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CCAAT/enhancer-binding protein beta</td>
<td style="text-align: right;">1350.0266</td>
</tr>
<tr class="even">
<td style="text-align: left;">E3 SUMO-protein ligase PIAS4</td>
<td style="text-align: right;">1074.8532</td>
</tr>
<tr class="odd">
<td style="text-align: left;">E3 ubiquitin-protein ligase CHIP</td>
<td style="text-align: right;">751.5539</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gamma-enolase</td>
<td style="text-align: right;">924.8701</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Induced myeloid leukemia cell differentiation protein Mcl-1</td>
<td style="text-align: right;">886.3500</td>
</tr>
<tr class="even">
<td style="text-align: left;">Interferon regulatory factor 1</td>
<td style="text-align: right;">1178.8104</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Interleukin-10 receptor subunit alpha</td>
<td style="text-align: right;">1778.6974</td>
</tr>
<tr class="even">
<td style="text-align: left;">Signal transducer and activator of transcription 3</td>
<td style="text-align: right;">448.6260</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Transcription factor AP-1</td>
<td style="text-align: right;">2983.3747</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>We see that the protein levels in <code>biomarker-raw.csv</code> seem to be incredibly high, with a lot of the proteins having mean levels at or above 1000. Additionally, we see hat a lot of the distributions are pretty heavily right-skewed, and thus are likely not to be normally distributed.</p>
<p>In contrast, when we look at the same proteins with log-transformed levels below, we see that the now the average protein level is close to 3, which is significantly lower than it was. Also, we see that the log-transform has decreased the skew of the distribution of the protein levels, causing them to be more similar to a normal distribution. We want to work with normally distributed data as often as possible, as it is easy to work with, and many data analytic techniques require normally distributed data.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="report_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Mean Log Levels of Selected Proteins</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Protein</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean Log Level</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CCAAT/enhancer-binding protein beta</td>
<td style="text-align: right;">3.112058</td>
</tr>
<tr class="even">
<td style="text-align: left;">E3 SUMO-protein ligase PIAS4</td>
<td style="text-align: right;">3.005355</td>
</tr>
<tr class="odd">
<td style="text-align: left;">E3 ubiquitin-protein ligase CHIP</td>
<td style="text-align: right;">2.723850</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gamma-enolase</td>
<td style="text-align: right;">2.941292</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Induced myeloid leukemia cell differentiation protein Mcl-1</td>
<td style="text-align: right;">2.932035</td>
</tr>
<tr class="even">
<td style="text-align: left;">Interferon regulatory factor 1</td>
<td style="text-align: right;">3.061256</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Interleukin-10 receptor subunit alpha</td>
<td style="text-align: right;">3.243383</td>
</tr>
<tr class="even">
<td style="text-align: left;">Signal transducer and activator of transcription 3</td>
<td style="text-align: right;">2.643626</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Transcription factor AP-1</td>
<td style="text-align: right;">3.461764</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="examining-outliers" class="level4">
<h4 class="anchored" data-anchor-id="examining-outliers">Examining Outliers</h4>
</section>
<section id="section" class="level4">
<h4 class="anchored" data-anchor-id="section"></h4>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Grouping Proteins by Number of Subjects with Outlier Value</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Protein Group</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Number of Proteins</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0-2 subject with an outlier value</td>
<td style="text-align: right;">777</td>
</tr>
<tr class="even">
<td style="text-align: left;">3-5 subjects with outlier values</td>
<td style="text-align: right;">335</td>
</tr>
<tr class="odd">
<td style="text-align: left;">&gt;5 subjects with outlier values</td>
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Most of the proteins had an outlier value in at least one participant, only 0.6833713% of proteins have 6 or more participants with an outlier value. The majority of proteins do not have have multiple subjects with an outlier value.</p>
</section>
<section id="are-certain-subjects-more-likely-to-have-outlier-values" class="level4">
<h4 class="anchored" data-anchor-id="are-certain-subjects-more-likely-to-have-outlier-values">Are certain subjects more likely to have outlier values?</h4>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Distribution of Amount of Outlier Proteins per Subjects</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Outlier Grouping</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Number of Subjects</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">&gt;100 outlier proteins</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">40-100 outlier proteins</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Less than or equal to 40 outlier proteins</td>
<td style="text-align: right;">141</td>
</tr>
</tbody>
</table>


</div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Outlier Subjects</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">ID</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Number of Proteins with Outlier Values</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Group</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Outlier Grouping</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">126</td>
<td style="text-align: left;">ASD</td>
<td style="text-align: left;">&gt;100 outlier proteins</td>
</tr>
<tr class="even">
<td style="text-align: right;">24</td>
<td style="text-align: right;">48</td>
<td style="text-align: left;">ASD</td>
<td style="text-align: left;">40-100 outlier proteins</td>
</tr>
<tr class="odd">
<td style="text-align: right;">52</td>
<td style="text-align: right;">121</td>
<td style="text-align: left;">ASD</td>
<td style="text-align: left;">&gt;100 outlier proteins</td>
</tr>
<tr class="even">
<td style="text-align: right;">77</td>
<td style="text-align: right;">114</td>
<td style="text-align: left;">TD</td>
<td style="text-align: left;">&gt;100 outlier proteins</td>
</tr>
<tr class="odd">
<td style="text-align: right;">100</td>
<td style="text-align: right;">47</td>
<td style="text-align: left;">TD</td>
<td style="text-align: left;">40-100 outlier proteins</td>
</tr>
<tr class="even">
<td style="text-align: right;">108</td>
<td style="text-align: right;">127</td>
<td style="text-align: left;">TD</td>
<td style="text-align: left;">&gt;100 outlier proteins</td>
</tr>
<tr class="odd">
<td style="text-align: right;">121</td>
<td style="text-align: right;">122</td>
<td style="text-align: left;">TD</td>
<td style="text-align: left;">&gt;100 outlier proteins</td>
</tr>
<tr class="even">
<td style="text-align: right;">131</td>
<td style="text-align: right;">45</td>
<td style="text-align: left;">TD</td>
<td style="text-align: left;">40-100 outlier proteins</td>
</tr>
<tr class="odd">
<td style="text-align: right;">147</td>
<td style="text-align: right;">77</td>
<td style="text-align: left;">TD</td>
<td style="text-align: left;">40-100 outlier proteins</td>
</tr>
<tr class="even">
<td style="text-align: right;">150</td>
<td style="text-align: right;">47</td>
<td style="text-align: left;">TD</td>
<td style="text-align: left;">40-100 outlier proteins</td>
</tr>
<tr class="odd">
<td style="text-align: right;">154</td>
<td style="text-align: right;">157</td>
<td style="text-align: left;">TD</td>
<td style="text-align: left;">&gt;100 outlier proteins</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>We see the majority of subjects seem to have less than or equal to 40 outlier proteins, with only 11 subjects having more than 40 proteins with outlier levels.</p>
<p>There do seem to be particular subjects that consistently have outlier protein values, with some subjects having outlier values in over 100 different proteins. Such subjects seem more likely to be in the typical developing group, with 8 subjects from the typical developing group having 40 or more proteins with outlier levels, and only 3 subjects from the ASD group having 40 or more proteins with outlier levels.</p>
</section>
</section>
<section id="methodological-variations-task-3" class="level3">
<h3 class="anchored" data-anchor-id="methodological-variations-task-3">Methodological variations (Task 3)</h3>
<section id="part-1-repeat-the-analysis" class="level4">
<h4 class="anchored" data-anchor-id="part-1-repeat-the-analysis">Part 1: Repeat the analysis</h4>
<p>Note: carry out the entire selection procedure on a training partition – in other words, set aside some testing data at the very beginning and don’t use it until you are evaluating accuracy at the very end</p>
<p>Replicating the feature selecting process on only the training dataset.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>    ASD TD class.error
ASD  34 26   0.4333333
TD   14 49   0.2222222</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  .metric     .estimator .estimate
  &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt;
1 sensitivity binary         0.75 
2 specificity binary         0.8  
3 accuracy    binary         0.774
4 roc_auc     binary         0.871</code></pre>
</div>
</div>
<p>We have these four proteins (DERM, IgD, TSP4, FSTL1) for our final panel.</p>
</section>
<section id="part-2-choose-a-larger-number-of-top-predictive-proteins" class="level4">
<h4 class="anchored" data-anchor-id="part-2-choose-a-larger-number-of-top-predictive-proteins">Part 2: Choose a larger number of top predictive proteins</h4>
<p>Note: more than ten and use each selection method</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> [1] "DERM"        "RELT"        "Calcineurin" "IgD"         "PTN"        
 [6] "FSTL1"       "MAPK2"       "TGF-b R III" "Notch 1"     "ALCAM"      
[11] "MATN2"      </code></pre>
</div>
</div>
<p>Now we have ten proteins (DERM, RELT, MRC2, IgD, PTN, FSTL1, Cadherin-5, MMP-2, Notch 1, ALCAM) in our final panel.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  .metric     .estimator .estimate
  &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt;
1 sensitivity binary         0.812
2 specificity binary         0.867
3 accuracy    binary         0.839
4 roc_auc     binary         0.946</code></pre>
</div>
</div>
<p><strong>Increasing the number of selected proteins</strong>: By expanding from 10 to 20 top proteins, we’ve allowed for potentially more relevant predictors, increasing the specificity slightly but not affecting sensitivity much. This change leads to more comprehensive protein coverage, improving accuracy and ROC AUC.</p>
</section>
<section id="part-3-fuzzy-intersection" class="level4">
<h4 class="anchored" data-anchor-id="part-3-fuzzy-intersection">Part 3: Fuzzy Intersection</h4>
<p>Note: instead of a hard intersection use a fuzzy intersection to combine the sets of top predictive proteins across selection methods. How are results affected by each modification?</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>$fuzzy_proteins
 [1] "DERM"            "RELT"            "Calcineurin"     "C1QR1"          
 [5] "MRC2"            "IgD"             "CXCL16, soluble" "PTN"            
 [9] "FSTL1"           "Cadherin-5"      "TGF-b R III"     "MAPK14"         
[13] "eIF-4H"          "M2-PK"           "SOST"            "ALCAM"          

$hard_intersection_proteins
[1] "DERM"  "RELT"  "IgD"   "FSTL1"</code></pre>
</div>
</div>
<p>This approach allows for greater flexibility in protein selection allowing for more in the protein list, potentially including proteins with lesser predictive strength, while the hard method ensures higher confidence in selected biomarkers.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  .metric     .estimator .estimate
  &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt;
1 sensitivity binary         0.562
2 specificity binary         0.733
3 accuracy    binary         0.645
4 roc_auc     binary         0.779</code></pre>
</div>
</div>
<p><strong>Using a fuzzy intersection</strong>: This modification aims to retain proteins chosen by either selection method, rather than only the exact matches. Although it captures more potential biomarkers, it lowers sensitivity and accuracy slightly, indicating that the fuzzy selection introduces less specific, possibly weaker predictors. ROC AUC remains high but shows reduced confidence in positive classification, as shown by lower sensitivity.</p>
</section>
</section>
<section id="improved-classifier-task-4" class="level3">
<h3 class="anchored" data-anchor-id="improved-classifier-task-4">Improved classifier (Task 4)</h3>
<section id="approach-1-lasso-regression" class="level4">
<h4 class="anchored" data-anchor-id="approach-1-lasso-regression">Approach 1: LASSO Regression</h4>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">.metric</th>
<th style="text-align: left;">.estimator</th>
<th style="text-align: right;">.estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">sensitivity</td>
<td style="text-align: left;">binary</td>
<td style="text-align: right;">0.7222222</td>
</tr>
<tr class="even">
<td style="text-align: left;">specificity</td>
<td style="text-align: left;">binary</td>
<td style="text-align: right;">0.8461538</td>
</tr>
<tr class="odd">
<td style="text-align: left;">accuracy</td>
<td style="text-align: left;">binary</td>
<td style="text-align: right;">0.7741935</td>
</tr>
<tr class="even">
<td style="text-align: left;">roc_auc</td>
<td style="text-align: left;">binary</td>
<td style="text-align: right;">0.7905983</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Having previously been provided with a model that used a multiple t-test and random forest model for the purpose of variable selection, we attempted to find out if we can create another panel with similar, or better, results. In our first approach, we implemented the lasso regression model with the goal of shrinking all predictors to zero except for at most 6. Originally, we wanted to find less than ten, but with some trial and error, the results showed that using only 6 proteins produced the best results. We were left with PTN, MAPK2, Coagulation Factor IX, IgD, DERM, and aldolase A, which we plugged into a logistic model, then calculating the performance metrics using the test data. From the results, the roc_auc and sensitivity of our model were lower than those of the in-class analysis, however, the accuracy was the same and the specificity was higher.</p>
</section>
<section id="approach-2-stepwise-variable-selection" class="level4">
<h4 class="anchored" data-anchor-id="approach-2-stepwise-variable-selection">Approach 2: Stepwise Variable Selection</h4>
<p>In the second approach, we split the data into a train/test split at a 80/20 proportion stratified across <code>class</code> to ensure even amounts of ASD and TD boys in both sets. In this approach, we opted for a different method of selecting predictors. Here, we performed forward selection, starting with a null model containing only an intercept and iteratively adding each of the 18 proteins identified in the study:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="report_files/possiblePreds.PNG" class="img-fluid figure-img"></p>
<figcaption>Possible Predictors Identified by Hewitson et al.</figcaption>
</figure>
</div>
<p>Performing Forward Stepwise Regression resulted in the below model:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = class ~ DERM + IgD + FCN1 + `eIF-4H` + PTN + C6 + 
    EPHB2 + ROR1, family = binomial, data = biomarker_train)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -0.1396     0.2749  -0.508 0.611533    
DERM         -1.2751     0.4735  -2.693 0.007080 ** 
IgD          -1.3722     0.3537  -3.879 0.000105 ***
FCN1          1.8395     0.4659   3.948 7.88e-05 ***
`eIF-4H`     -0.9204     0.3330  -2.764 0.005717 ** 
PTN          -1.1800     0.4400  -2.682 0.007320 ** 
C6            0.8957     0.3857   2.322 0.020224 *  
EPHB2        -1.2375     0.4648  -2.662 0.007758 ** 
ROR1          1.3146     0.5351   2.457 0.014025 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 169.095  on 121  degrees of freedom
Residual deviance:  85.141  on 113  degrees of freedom
AIC: 103.14

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<p>From the above output of <code>summary(forward_model)</code>, we see that 8 out of the 18 proteins were selected to be included as predictors of ASD. The selected proteins were <strong>DERM, IgD, FCN1, eIF-4H, PTN, C6, EPHB2, and ROR1.</strong></p>
<p>Interestingly, the model found through forward stepwise selection did not include the proteins MAPK14 or suPAR, which is surprising considering that these proteins were part of the “core panel” found by Hewitson et al., meaning that each of the three methods used in the study identified these as being significant predictors of ASD. Despite the exclusion of these two “core” proteins, this model performed well on the testing data, achieving the below sensitivity, specificity, accuracy, and ROC AUC.</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">.metric</th>
<th style="text-align: left;">.estimator</th>
<th style="text-align: right;">.estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">sensitivity</td>
<td style="text-align: left;">binary</td>
<td style="text-align: right;">0.8125000</td>
</tr>
<tr class="even">
<td style="text-align: left;">specificity</td>
<td style="text-align: left;">binary</td>
<td style="text-align: right;">0.8750000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">accuracy</td>
<td style="text-align: left;">binary</td>
<td style="text-align: right;">0.8437500</td>
</tr>
<tr class="even">
<td style="text-align: left;">roc_auc</td>
<td style="text-align: left;">binary</td>
<td style="text-align: right;">0.9101562</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>